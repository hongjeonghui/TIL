# TIL: Managing Tables & Multi Table Queries in SQL

## 1. Managing Tables

### (1) CREATE TABLE

```sql
CREATE TABLE table_name (
    column_1 data_type constraints,
    column_2 data_type constraints,
    ...
);
```

- 각 필드에 **데이터 타입**과 **제약조건**을 명시해야 함.  
- 예시:

```sql
CREATE TABLE examples(
    ExamId INTEGER PRIMARY KEY AUTOINCREMENT,
    LastName VARCHAR(50) NOT NULL,
    FirstName VARCHAR(50) NOT NULL
);
```

#### 📘 PRAGMA
- 테이블 구조 확인:
  ```sql
  PRAGMA table_info('examples');
  ```

#### 데이터 타입
| 타입 | 설명 |
|------|------|
| NULL | 값 없음 |
| INTEGER | 정수형 |
| REAL | 실수형 |
| TEXT | 문자열 |
| BLOB | 이미지, 동영상 등 바이너리 데이터 |

#### 제약 조건 (Constraints)
- **PRIMARY KEY**: 기본 키 지정 (INTEGER 타입에만 적용)
- **NOT NULL**: NULL 값 입력 불가
- **FOREIGN KEY**: 다른 테이블과의 외래 키 관계 설정

#### AUTOINCREMENT 특징
- 자동 증가 키워드  
- 항상 이전 최대값보다 큰 값으로 증가  
- 삭제된 값은 재사용 불가

---

### (2) ALTER TABLE

| 명령어 | 기능 |
|--------|------|
| `ALTER TABLE ADD COLUMN` | 컬럼 추가 |
| `ALTER TABLE RENAME COLUMN` | 컬럼 이름 변경 |
| `ALTER TABLE DROP COLUMN` | 컬럼 삭제 |
| `ALTER TABLE RENAME TO` | 테이블 이름 변경 |

#### ADD COLUMN
```sql
ALTER TABLE examples
ADD COLUMN Country VARCHAR(100) NOT NULL DEFAULT 'default value';
```
> SQLite는 **한 번에 하나의 컬럼만 추가 가능**

#### RENAME COLUMN
```sql
ALTER TABLE examples
RENAME COLUMN Address TO PostCode;
```

#### DROP COLUMN
```sql
ALTER TABLE examples
DROP COLUMN PostCode;
```

#### RENAME TO
```sql
ALTER TABLE examples
RENAME TO new_examples;
```

---

### (3) DROP TABLE

```sql
DROP TABLE table_name;
```

- 테이블 삭제 시 사용
- SQLite는 컬럼 수정 불가 → 새 테이블 생성 후 데이터 복사 필요

---

## 2. Modifying Data

### (1) INSERT

```sql
INSERT INTO table_name (c1, c2, ...)
VALUES (v1, v2, ...);
```

#### 예시
```sql
INSERT INTO articles (title, content, createdAt)
VALUES ('hello', 'world', '2000-01-01');
```

여러 행 한 번에 추가:
```sql
INSERT INTO articles (title, content, createdAt)
VALUES
    ('title1', 'content1', '1900-01-01'),
    ('title2', 'content2', '1800-01-01'),
    ('title3', 'content3', '1700-01-01');
```

현재 날짜로 입력:
```sql
INSERT INTO articles (title, content, createdAt)
VALUES ('mytitle', 'mycontent', DATE());
```

---

### (2) UPDATE

```sql
UPDATE table_name
SET column_name = new_value
WHERE condition;
```

#### 예시
```sql
UPDATE articles
SET title = 'update Title'
WHERE id = 1;

UPDATE articles
SET title = 'update Title', content = 'update Content'
WHERE id = 2;
```

---

### (3) DELETE

```sql
DELETE FROM table_name
WHERE condition;
```

#### 예시
```sql
DELETE FROM articles
WHERE id = 1;
```

작성일이 오래된 순으로 2개 삭제:
```sql
DELETE FROM articles
WHERE id IN (
    SELECT id FROM articles
    ORDER BY createdAt
    LIMIT 2
);
```

---

## 3. Multi Table Queries

### (1) 관계의 필요성

- 게시글과 작성자 정보를 분리하여 관리하기 위해 테이블 분리
- 외래 키(`userId`, `roleId`)를 사용해 관계 설정

---

### (2) JOIN

- **JOIN**은 여러 테이블을 결합하여 데이터를 함께 조회할 때 사용됨

#### JOIN 종류
1. **INNER JOIN** – 교집합 (두 테이블 모두에 존재하는 데이터)
2. **LEFT JOIN** – 왼쪽 테이블 기준으로 모든 행 표시 (오른쪽이 없으면 NULL)

---

### (3) INNER JOIN

```sql
SELECT select_list
FROM table_a
INNER JOIN table_b
ON table_b.fk = table_a.pk;
```

#### 예시
```sql
SELECT *
FROM articles
INNER JOIN users
ON users.id = articles.userId;
```

특정 작성자 게시글 조회:
```sql
SELECT articles.title, users.name
FROM articles
INNER JOIN users
ON users.id = articles.userId
WHERE users.id = 1;
```

---

### (4) LEFT JOIN

```sql
SELECT select_list
FROM table_a
LEFT JOIN table_b
ON table_b.fk = table_a.pk;
```

#### 예시
모든 게시글 + 작성자 정보:
```sql
SELECT *
FROM articles
LEFT JOIN users
ON users.id = articles.userId;
```

게시글이 없는 회원 조회:
```sql
SELECT users.name
FROM users
LEFT JOIN articles
ON articles.userId = users.id
WHERE articles.userId IS NULL;
```

---

## 🧭 Summary

| 주제 | 핵심 포인트 |
|------|--------------|
| CREATE TABLE | 데이터 타입 + 제약조건 명시 |
| ALTER TABLE | 컬럼 추가/이름 변경/삭제 가능 |
| DROP TABLE | 테이블 완전 삭제 |
| INSERT | 데이터 추가 |
| UPDATE | 데이터 수정 |
| DELETE | 데이터 삭제 |
| JOIN | 여러 테이블을 연결해 조회 |
| INNER JOIN | 양쪽에 모두 존재하는 데이터만 |
| LEFT JOIN | 왼쪽 테이블 기준 전체 표시 |

---

📅 **오늘 배운 핵심:**  
테이블 생성부터 수정, 삭제, 그리고 다중 테이블 관계를 활용한 JOIN까지 SQL의 기본 구조를 익혔다.  
데이터 무결성과 관계형 구조의 중요성을 이해하는 데 도움이 된 수업이었다.
